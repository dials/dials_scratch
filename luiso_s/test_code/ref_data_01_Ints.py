
'''a=[16 ,  10 ,  17 ,  14 ,  10 ,  12 ,  14 ,   9 ,  19 ,   8 ,  12 ,  17 ,  18 ,  22 ,  18 ,  14 ,  16 ,  26 ,  18 ,  13,
  15 ,   8 ,   6 ,  13 ,   9 ,  13 ,   9 ,  14 ,  16 ,  12 ,  15 ,  19 ,  13 ,  12 ,  14 ,  12 ,  14 ,  15 ,  20 ,  18,
   6 ,  11 ,  11 ,  14 ,  13 ,  18 ,   8 ,  12 ,   8 ,  12 ,   6 ,  13 ,  17 ,  24 ,  15 ,  19 ,  15 ,  13 ,  18 ,  18,
  13 ,   6 ,   7 ,   3 ,  10 ,  10 ,  13 ,  19 ,   7 ,  13 ,  16 ,  16 ,  17 ,  22 ,  20 ,  20 ,  23 ,  12 ,  18 ,  15,
  10 ,   9 ,   7 ,  10 ,  13 ,   9 ,  14 ,  10 ,  12 ,  11 ,  11 ,  27 ,  32 ,  51 ,  45 ,  21 ,  21 ,  13 ,  23 ,  19,
  11 ,   6 ,  13 ,  11 ,  14 ,   9 ,   8 ,   9 ,  15 ,  17 ,  40 ,  78 ,  90 ,  67 ,  57 ,  19 ,  19 ,  19 ,  17 ,  12,
  13 ,   3 ,   8 ,   8 ,  17 ,  14 ,  13 ,  14 ,  25 ,  47 , 100 , 164 , 129 ,  76 ,  48 ,  12 ,  17 ,  20 ,   9 ,  12,
   5 ,  11 ,  11 ,   6 ,  10 ,   6 ,  12 ,  24 ,  57 , 143 , 220 , 257 , 150 ,  67 ,  26 ,   8 ,  17 ,   9 ,  13 ,  22,
   7 ,  12 ,   9 ,  11 ,   9 ,  12 ,  31 ,  54 , 137 , 270 , 306 , 233 , 102 ,  38 ,  24 ,  16 ,   9 ,   7 ,  19 ,  17,
  12 ,  10 ,   3 ,  13 ,  12 ,  20 ,  47 , 113 , 280 , 343 , 290 , 130 ,  45 ,  23 ,   7 ,  13 ,  19 ,  10 ,  12 ,  16,
  10 ,   9 ,   8 ,  12 ,   8 ,  27 ,  87 , 227 , 310 , 283 , 154 ,  57 ,  31 ,  20 ,  18 ,  14 ,  13 ,  14 ,  13 ,  24,
  11 ,  11 ,   9 ,   6 ,  23 ,  53 , 145 , 241 , 211 , 153 ,  60 ,  20 ,  13 ,  19 ,   7 ,  14 ,  11 ,   6 ,  15 ,  16,
  10 ,   8 ,   4 ,  20 ,  20 ,  75 , 153 , 129 , 103 ,  41 ,  24 ,  16 ,  14 ,  19 ,  11 ,  21 ,  15 ,  17 ,  15 ,   3,
   5 ,  10 ,   5 ,  23 ,  35 ,  66 ,  87 ,  51 ,  45 ,  20 ,  14 ,  13 ,   7 ,  13 ,  10 ,  11 ,  14 ,  19 ,  16 ,  11,
  11 ,   9 ,   8 ,  17 ,  24 ,  45 ,  34 ,  16 ,  15 ,   8 ,  12 ,  14 ,   9 ,  14 ,  11 ,   9 ,  12 ,  20 ,  18 ,  12,
   7 ,  11 ,  16 ,  10 ,  18 ,  11 ,  12 ,  12 ,   9 ,  10 ,   9 ,   9 ,   9 ,  11 ,  11 ,  14 ,   8 ,  17 ,  20 ,  17,
  11 ,  10 ,   9 ,  10 ,   7 ,  13 ,  12 ,  14 ,   4 ,  13 ,  11 ,  12 ,  11 ,  10 ,  11 ,   8 ,  16 ,  19 ,  10 ,  15,
  15 ,   5 ,   8 ,  18 ,   7 ,  12 ,  14 ,   9 ,   6 ,   6 ,   8 ,   7 ,   6 ,   4 ,  11 ,  18 ,  17 ,  13 ,  15 ,  16,
   4 ,   8 ,   5 ,  12 ,   7 ,  13 ,  10 ,   8 ,   9 ,  17 ,   5 ,  13 ,   7 ,  12 ,  13 ,  13 ,  19 ,  18 ,  11 ,  17,
   8 ,   3 ,   8 ,   8 ,   7 ,   9 ,   7 ,   6 ,   9 ,  10 ,  12 ,  16 ,   8 ,   8 ,  16 ,   7 ,  18 ,   8 ,  14 ,  17]
for i in a:
  print i
print a
'''
lst_msk=[]


lst_msk.append([3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,5,5,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,3,5,5,5,5,5,3,5,3,
3,3,3,3,3,3,3,3,3,3,3,5,5,5,5,5,5,3,3,3,
3,3,3,3,3,3,3,3,3,3,5,5,5,5,5,5,5,3,3,3,
3,3,3,3,3,3,3,5,3,5,5,5,5,5,5,5,3,3,3,3,
3,3,3,3,3,3,3,5,5,5,5,5,5,5,5,5,5,5,3,3,
3,3,3,3,3,5,5,5,5,5,5,5,5,5,5,5,3,3,3,3,
3,3,3,3,3,5,5,5,5,5,5,5,5,5,5,5,3,3,3,3,
3,3,3,3,5,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,
3,3,3,3,5,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,
3,3,3,3,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,3,
3,3,3,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,3,3,
3,3,5,5,5,5,5,5,5,5,3,3,3,3,3,3,3,3,3,3,
3,3,5,5,5,5,5,5,5,3,3,3,3,3,3,3,3,3,3,3,
5,5,5,5,5,5,5,3,5,3,3,3,3,3,3,3,3,3,3,3,
5,5,3,5,5,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
3,3,3,3,3,5,3,3,5,3,3,3,3,3,3,3,3,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3])


lst_msk.append([3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,3,3,3,5,3,5,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,3,3,5,5,5,5,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,5,5,5,5,5,5,5,3,3,
3,3,3,3,3,3,3,3,3,3,5,5,5,5,5,5,5,5,3,3,
3,3,3,3,3,3,3,3,3,5,5,5,5,5,5,5,5,3,3,3,
3,3,3,3,3,3,3,5,5,5,5,5,5,5,5,5,3,3,3,3,
3,3,3,3,3,3,3,5,5,5,5,5,5,5,5,5,3,3,3,3,
3,3,3,3,3,5,5,5,5,5,5,5,5,5,3,5,3,3,3,3,
3,3,3,3,5,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,
3,3,3,3,5,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,
3,3,3,5,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,3,
3,3,3,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,3,3,
3,3,5,5,5,5,5,5,5,5,3,3,3,3,3,3,3,3,3,3,
3,3,5,5,5,5,5,5,5,5,3,3,3,3,3,3,3,3,3,3,
3,3,5,5,5,5,5,5,3,5,3,3,3,3,3,3,3,3,3,3,
3,5,5,5,5,5,5,3,3,3,3,3,3,3,3,3,3,3,3,3,
3,3,5,3,5,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
3,3,3,3,5,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3])


lst_msk.append([3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,5,3,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,3,3,5,5,5,5,5,3,3,
3,3,3,3,3,3,3,3,3,3,3,5,5,5,5,5,5,3,3,3,
3,3,3,3,3,3,3,3,3,5,5,5,5,5,5,5,5,3,3,3,
3,3,3,3,3,3,3,3,3,5,5,5,5,5,5,5,5,3,3,3,
3,3,3,3,3,3,3,3,5,5,5,5,5,5,5,5,3,3,3,3,
3,3,3,3,3,3,5,5,5,5,5,5,5,5,5,5,3,3,3,3,
3,3,3,3,3,3,5,5,5,5,5,5,5,5,5,5,3,3,3,3,
3,3,3,5,3,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,
3,3,3,5,5,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,
3,3,3,5,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,3,
3,3,5,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,3,3,
3,3,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,3,3,3,
3,3,5,5,5,5,5,5,5,3,3,3,3,3,3,3,3,3,3,3,
3,5,5,5,5,5,5,5,3,3,3,3,3,3,3,3,3,3,3,3,
3,5,5,5,5,5,3,5,3,3,3,3,3,3,3,3,3,3,3,3,
3,5,5,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3])



lst_msk.append([3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,5,3,5,3,3,
3,3,3,3,3,3,3,3,3,3,5,3,3,5,5,5,5,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,3,5,5,5,5,5,5,3,3,
3,3,3,3,3,3,3,3,3,3,5,5,5,5,5,5,5,3,3,3,
3,3,3,3,3,3,3,3,5,5,5,5,5,5,5,5,5,3,3,3,
3,3,3,3,3,3,3,5,5,5,5,5,5,5,5,5,3,3,3,3,
3,3,3,3,3,3,3,5,5,5,5,5,5,5,5,3,5,3,3,3,
3,3,3,3,5,3,5,5,5,5,5,5,5,5,5,5,3,3,3,3,
3,3,3,3,3,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,
3,3,3,5,3,5,5,5,5,5,5,5,5,3,3,3,3,3,3,3,
3,3,3,5,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,3,
3,3,5,5,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,3,
3,3,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,3,3,3,
3,5,3,5,5,5,5,5,5,5,3,3,3,3,3,3,3,3,3,3,
3,3,5,5,5,5,5,5,3,3,3,3,3,3,3,3,3,3,3,3,
3,5,5,3,5,3,5,3,3,3,3,3,3,3,3,3,3,3,3,3,
3,5,3,3,5,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3])


lst_msk.append([3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,5,5,3,
3,3,3,3,3,3,3,3,3,3,3,3,3,3,5,3,5,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,3,5,5,5,5,5,5,3,3,
3,3,3,3,3,3,3,3,3,3,3,5,5,5,5,5,3,3,3,3,
3,3,3,3,3,3,3,3,3,5,5,5,5,5,5,5,5,3,3,3,
3,3,3,3,3,3,3,3,5,5,5,5,5,5,5,5,3,3,3,3,
3,3,3,3,3,3,3,5,5,5,5,5,5,5,5,5,5,3,3,3,
3,3,3,3,3,3,5,5,5,5,5,5,5,5,5,5,3,3,3,3,
3,3,3,3,3,3,5,5,5,5,5,5,5,5,5,5,3,3,3,3,
3,3,3,3,5,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,
3,3,3,3,5,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,
3,3,5,5,5,5,5,5,5,5,5,5,5,3,3,3,3,3,3,3,
3,3,3,5,5,5,5,5,5,5,5,3,3,3,3,3,3,3,3,3,
3,3,5,5,5,5,5,5,5,5,3,3,3,3,3,3,3,3,3,3,
5,3,3,5,5,5,5,5,5,5,3,3,3,3,3,3,3,3,3,3,
3,5,5,5,5,5,5,5,5,3,3,3,3,3,3,3,3,3,3,3,
5,3,5,5,5,5,3,5,3,3,3,3,3,3,3,3,3,3,3,3,
5,3,5,5,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,
3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3])

lst_img=[]
lst_img.append([16,10,17,14,10,12,14,9,19,8,12,17,18,22,18,14,16,26,18,13,
15,8,6,13,9,13,9,14,16,12,15,19,13,12,14,12,14,15,20,18,
6,11,11,14,13,18,8,12,8,12,6,13,17,24,15,19,15,13,18,18,
13,6,7,3,10,10,13,19,7,13,16,16,17,22,20,20,23,12,18,15,
10,9,7,10,13,9,14,10,12,11,11,27,32,51,45,21,21,13,23,19,
11,6,13,11,14,9,8,9,15,17,40,78,90,67,57,19,19,19,17,12,
13,3,8,8,17,14,13,14,25,47,100,164,129,76,48,12,17,20,9,12,
5,11,11,6,10,6,12,24,57,143,220,257,150,67,26,8,17,9,13,22,
7,12,9,11,9,12,31,54,137,270,306,233,102,38,24,16,9,7,19,17,
12,10,3,13,12,20,47,113,280,343,290,130,45,23,7,13,19,10,12,16,
10,9,8,12,8,27,87,227,310,283,154,57,31,20,18,14,13,14,13,24,
11,11,9,6,23,53,145,241,211,153,60,20,13,19,7,14,11,6,15,16,
10,8,4,20,20,75,153,129,103,41,24,16,14,19,11,21,15,17,15,3,
5,10,5,23,35,66,87,51,45,20,14,13,7,13,10,11,14,19,16,11,
11,9,8,17,24,45,34,16,15,8,12,14,9,14,11,9,12,20,18,12,
7,11,16,10,18,11,12,12,9,10,9,9,9,11,11,14,8,17,20,17,
11,10,9,10,7,13,12,14,4,13,11,12,11,10,11,8,16,19,10,15,
15,5,8,18,7,12,14,9,6,6,8,7,6,4,11,18,17,13,15,16,
4,8,5,12,7,13,10,8,9,17,5,13,7,12,13,13,19,18,11,17,
8,3,8,8,7,9,7,6,9,10,12,16,8,8,16,7,18,8,14,17])

lst_img.append([10,9,17,11,11,13,16,15,14,14,15,15,13,12,16,22,17,18,21,13,
9,11,12,9,13,13,13,19,11,20,17,15,15,14,15,17,18,13,25,17,
9,8,15,11,14,6,14,13,15,14,15,14,15,17,25,20,10,14,22,26,
8,8,11,13,10,22,13,13,17,18,24,17,28,18,28,17,18,20,11,16,
7,10,16,13,5,12,14,17,14,15,24,27,45,57,30,20,26,24,22,23,
7,17,14,15,9,20,13,21,14,20,41,74,77,71,48,23,23,12,27,20,
13,14,22,16,7,18,14,16,25,47,103,146,142,85,42,24,18,20,22,28,
11,12,9,15,16,20,15,16,62,150,225,209,152,77,32,25,19,18,22,22,
14,14,11,16,18,13,28,63,169,290,353,235,100,38,22,24,19,21,22,12,
14,11,16,10,15,25,50,138,285,357,292,149,57,18,21,25,18,22,20,22,
14,12,22,17,17,34,115,234,303,290,170,69,35,24,20,21,15,17,29,19,
11,14,11,21,27,66,171,258,248,132,60,28,23,21,20,16,21,21,24,24,
14,28,20,26,33,91,149,158,117,63,24,22,18,15,23,20,15,24,24,24,
8,14,14,34,49,74,98,74,33,25,17,17,21,26,16,30,28,34,17,31,
14,16,19,20,44,46,43,22,23,17,30,22,20,21,22,22,16,18,29,21,
15,22,18,23,24,24,22,19,21,11,18,21,20,27,25,27,24,27,18,19,
8,19,12,19,15,24,18,17,19,23,22,31,23,19,21,27,29,23,22,33,
24,21,18,23,17,17,29,19,18,14,24,21,27,31,20,16,18,25,29,24,
18,17,22,23,16,16,20,22,21,18,19,29,20,25,23,20,26,20,27,27,
13,16,10,18,20,19,23,24,24,23,19,28,19,26,29,24,18,22,22,22])

lst_img.append([15,8,12,12,14,11,18,19,14,16,14,9,16,23,15,14,26,17,12,14,
7,11,10,15,9,14,9,17,12,11,12,14,14,20,12,15,20,25,13,11,
13,9,8,10,9,12,20,13,14,20,14,14,19,10,16,17,18,12,21,11,
8,7,13,6,6,9,13,10,11,14,15,15,21,21,20,24,23,23,20,14,
10,4,9,11,8,11,19,10,14,12,9,28,37,49,38,16,19,15,12,16,
10,8,8,9,11,12,10,7,20,10,36,54,82,74,48,21,13,19,17,21,
7,5,9,8,9,8,13,10,19,31,99,137,140,78,36,17,15,12,14,22,
8,5,13,5,7,10,8,16,44,153,212,211,173,50,19,15,11,17,22,9,
9,5,2,2,10,11,12,51,137,275,285,235,109,33,20,12,15,11,10,27,
7,4,4,9,5,14,44,119,302,351,299,129,44,10,22,9,23,15,15,12,
5,6,7,8,10,27,97,229,307,279,158,60,22,8,11,16,16,14,14,16,
3,7,5,10,27,72,134,248,219,138,55,9,12,12,10,13,14,12,19,18,
5,4,5,12,48,84,136,140,94,56,17,11,9,11,11,16,17,12,12,11,
1,3,7,11,23,66,101,61,29,9,7,6,10,8,10,11,7,12,16,14,
3,3,8,14,35,46,33,20,14,5,5,10,8,12,15,15,10,8,13,10,
3,7,9,10,13,13,15,10,8,8,6,8,12,15,11,8,9,8,11,7,
0,6,9,10,7,6,13,1,7,7,7,8,12,13,5,18,11,12,14,13,
6,5,5,6,1,7,4,7,6,8,8,9,8,12,6,9,7,11,11,12,
1,1,2,2,3,2,2,8,7,4,2,6,6,6,7,7,11,12,5,8,
2,1,4,3,3,7,3,5,5,3,10,10,9,5,4,7,9,4,5,14])

lst_img.append([13,8,15,8,11,8,8,5,6,3,4,5,5,7,1,6,1,2,3,3,
8,8,6,5,10,9,8,12,7,9,9,4,5,3,4,8,7,6,3,0,
7,13,9,18,5,4,8,14,10,1,6,3,5,6,11,6,5,3,1,3,
14,10,11,8,6,11,10,9,8,6,10,4,11,13,16,17,8,9,9,8,
12,13,12,11,10,4,13,14,10,8,8,17,29,46,20,21,10,7,2,3,
16,14,7,7,5,11,6,7,12,18,31,67,82,60,33,12,6,9,7,4,
16,7,18,9,9,12,9,11,14,44,100,156,150,80,33,14,8,3,7,6,
17,12,11,5,16,13,10,16,61,131,231,235,134,56,13,12,9,6,5,2,
10,8,13,11,9,14,22,62,164,264,302,221,89,31,11,3,4,11,6,3,
11,12,19,13,8,12,53,147,256,337,271,143,44,14,4,7,9,8,9,9,
21,14,15,16,14,43,108,240,315,278,159,49,11,10,7,9,11,5,6,4,
16,13,12,12,25,48,157,227,217,147,49,24,13,10,9,9,7,13,12,6,
13,20,16,20,45,83,137,131,96,52,17,10,10,13,7,11,3,10,8,7,
15,9,20,31,52,73,84,69,36,22,8,9,11,8,11,14,8,4,6,4,
27,13,11,28,46,49,49,27,11,17,11,14,12,5,12,14,6,9,13,7,
14,18,17,19,23,26,16,11,12,12,12,11,14,12,14,8,11,10,7,11,
15,15,13,19,17,10,17,16,18,16,11,12,14,7,7,13,10,15,9,6,
17,23,17,14,20,11,12,22,12,15,16,16,15,12,4,8,4,17,8,4,
15,17,14,15,16,13,22,22,20,10,17,14,12,14,7,8,13,11,10,8,
21,19,20,20,10,16,10,15,18,7,17,9,10,13,16,14,12,8,5,7])

lst_img.append([28,16,12,24,14,19,21,20,18,20,14,23,14,14,13,11,15,9,16,13,
15,25,14,16,18,20,12,16,20,12,14,11,11,10,24,17,9,18,11,18,
21,19,19,24,18,15,11,15,20,22,14,11,16,18,17,16,16,19,8,14,
15,19,13,20,17,21,23,22,15,10,17,11,25,26,19,14,11,11,10,15,
21,9,25,11,13,17,20,18,21,20,12,31,38,36,38,29,14,11,12,9,
17,17,12,19,17,11,18,16,18,17,36,78,79,78,41,19,11,9,14,11,
16,17,16,13,15,13,17,18,25,55,120,179,137,84,34,16,12,12,14,9,
10,6,16,21,13,14,18,18,59,151,233,242,136,46,24,16,7,10,10,16,
17,17,15,7,12,12,21,62,169,270,324,216,79,30,16,9,11,8,10,4,
21,11,14,14,20,15,48,128,263,320,245,149,36,15,9,11,10,13,5,9,
22,15,15,20,12,41,106,209,337,271,146,61,19,8,10,16,14,8,9,6,
12,13,14,13,15,52,131,271,229,136,54,18,16,7,7,10,10,8,7,11,
15,22,9,19,34,89,139,159,105,41,26,12,11,7,7,8,5,9,14,6,
16,16,11,22,46,79,73,64,38,14,10,9,14,10,13,8,6,3,8,6,
15,9,13,23,33,36,17,21,20,11,6,10,8,13,7,9,7,14,6,5,
15,16,10,20,17,19,14,12,12,7,10,8,15,4,6,7,10,4,5,6,
13,11,24,11,17,16,10,8,7,10,11,9,8,7,2,10,6,8,7,2,
13,13,13,15,9,12,6,19,12,7,7,8,11,5,9,3,6,6,3,12,
16,11,16,10,9,11,10,8,11,5,11,8,9,7,7,9,8,10,10,2,
13,9,11,9,13,9,13,9,3,22,9,5,6,8,4,9,3,9,2,2])

mask_lst=[]

from matplotlib import pyplot as plt
import numpy

for b in lst_msk:
  row = 0
  col = -1
  data_msk = numpy.zeros((1, 20, 20), dtype = numpy.int32)
  data_msk2d = numpy.zeros((20, 20), dtype = numpy.float64)
  for m in b:
    col += 1
    if col == 20:
      col=0
      row += 1
    data_msk[0,row,col] = m
  mask_lst.append(data_msk)



data_lst=[]
var_slp=-2
for b in lst_img:
  if float(var_slp)/float(2)==int(var_slp/2):
    var_slp01 = -2
  else:
    var_slp01 = 2
  row = 0
  col = -1
  data_img = numpy.zeros((1, 20, 20), dtype = numpy.float64)
  data_img2d = numpy.zeros((20, 20), dtype = numpy.float64)

  for m in b:
    col += 1
    if col == 20:
      col=0
      row += 1
    data_img[0,row,col] = m + col * var_slp * 3 + row * var_slp01 * 2
  data_lst.append(data_img)
  var_slp += 1


from dials.model.data import Reflection, ReflectionList
from scitbx.array_family import flex
r_lst=ReflectionList()
for i in range(len(data_lst)):
  r = Reflection()
  r.shoebox = flex.double(data_lst[i])
  r.shoebox_mask = flex.int(mask_lst[i])
  r.shoebox_background = flex.double(data_lst[i])
  r_lst.append(r)
for r in r_lst:
  data_msk=r.shoebox.as_numpy_array()
  data_msk2d[:,:]=data_msk[0:1,:,:]
  plt.imshow(data_msk2d, interpolation = "nearest")
  plt.show()
  data_img=r.shoebox_mask.as_numpy_array()
  data_msk2d[:,:]=data_img[0:1,:,:]
  plt.imshow(data_msk2d, interpolation = "nearest")
  plt.show()
from dials.algorithms.background.inclined_background_subtractor \
 import layering_and_background_plane
layering_and_background_plane(r_lst)

for r in r_lst:
  data_img=r.shoebox_background.as_numpy_array()
  data_msk2d[:,:]=data_img[0:1,:,:]
  plt.imshow(data_msk2d, interpolation = "nearest")
  plt.show()


big_nrow = 41
big_ncol = 41
sumation = flex.double(flex.grid(big_nrow, big_ncol))
descr = flex.double(flex.grid(1, 3))

for ref in r_lst:
  shoebox = ref.shoebox
  background = ref.shoebox_background
  data2d = shoebox[0:1, :, :]
  #mask2d = mask[0:1, :, :]
  background2d = background[0:1, :, :]

  data2d.reshape(flex.grid(shoebox.all()[1:]))
  #mask2d.reshape(flex.grid(shoebox.all()[1:]))
  background2d.reshape(flex.grid(shoebox.all()[1:]))

  descr[0, 0] = 10.5
  descr[0, 1] = 10.5
  descr[0, 2] = 1.0
  peak2d = subtrac_bkg_2d(data2d, background2d)
  sumation = add_2d(descr, peak2d, sumation)

data_img=sumation.as_numpy_array()
plt.imshow(data_img, interpolation = "nearest")
plt.show()
